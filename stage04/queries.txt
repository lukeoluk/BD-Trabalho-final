COMANDOS Cypher

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/lukeoluk/BD-Trabalho-final/main/stage03/notebook/owid-country-data.csv' AS line CREATE(:Country {iso_code: line.iso_code, continente: line.continent, name: line.location, idh: line.human_development_index, pib_per_capita: line.gdp_per_capita})

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/lukeoluk/BD-Trabalho-final/main/stage03/notebook/owid-covid-data.csv' AS line CREATE(:CasosCovid{iso_code: line.iso_code, data: line.date, casos_total: line.total_cases, novos_casos: line.new_cases, mortes_total: line.total_deaths, novas_mortes: line.new_tests, total_testes: line.total_tests})

CREATE INDEX ON :Country(iso_code)

CREATE INDEX ON :CasosCovid(iso_code)
 
MATCH(c: Country)                            // Pega casos de COVID atÃ© agosto
MATCH(d: CasosCovid)
WHERE c.iso_code = d.iso_code AND d.data = '2020-08-31'
CREATE (c)-[:casosCovid]->(d)

MATCH (c:Country)-[:casosCovid]->(d:CasosCovid)  
			// Cria arestas entre paises e seus casos de Covid
RETURN c, d
LIMIT 30

MATCH (c:Country)-[:casosCovid]->(d:CasosCovid)
WHERE toFloat(d.casos_total) > 50000    
RETURN c, d
LIMIT 20

MATCH (c:Country)-[t:casosCovid]->(d:CasosCovid)
WHERE toFloat(d.casos_total) > 50000 AND toFloat(c.idh) < 0.5 // Retorna paises com menor IDH

RETURN c,d
LIMIT 20

MATCH (c:Country)-[t:casosCovid]->(d:CasosCovid)
WHERE toFloat(d.casos_total) > 50000 AND toFloat(c.idh) > 0.5 AND toFloat(c.idh) < 0.799  // Retorna paises com IDH medio
RETURN c,d
LIMIT 20

MATCH (c:Country)-[t:casosCovid]->(d:CasosCovid)
WHERE toFloat(d.casos_total) > 50000 AND toFloat(c.idh) > 0.799 // Retorna paises com IDH alto
RETURN c,d
LIMIT 20













